<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>TaskFolder.RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Microsoft.Win32.TaskScheduler.TaskFolder.RegisterTaskDefinition(System.String,Microsoft.Win32.TaskScheduler.TaskDefinition,Microsoft.Win32.TaskScheduler.TaskCreation,System.String,System.String,Microsoft.Win32.TaskScheduler.TaskLogonType,System.String)" /><meta name="Description" content="Registers (creates) a task in a specified location using a instance to define a task." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="file" content="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1" /><meta name="guid" content="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Task Scheduler Managed Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library" tocid="roottoc">Task Scheduler Managed Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_TaskScheduler.htm" title="Task Scheduler Managed Class Library Help" tocid="R_Project_TaskScheduler">Task Scheduler Managed Class Library Help</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_Microsoft_Win32_TaskScheduler.htm" title="Microsoft.Win32.TaskScheduler" tocid="N_Microsoft_Win32_TaskScheduler">Microsoft.Win32.TaskScheduler</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_Microsoft_Win32_TaskScheduler_TaskFolder.htm" title="TaskFolder Class" tocid="T_Microsoft_Win32_TaskScheduler_TaskFolder">TaskFolder Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_Microsoft_Win32_TaskScheduler_TaskFolder.htm" title="TaskFolder Methods" tocid="Methods_T_Microsoft_Win32_TaskScheduler_TaskFolder">TaskFolder Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm" title="RegisterTaskDefinition Method " tocid="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition">RegisterTaskDefinition Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm" title="RegisterTaskDefinition Method (String, TaskDefinition)" tocid="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition">RegisterTaskDefinition Method (String, TaskDefinition)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1.htm" title="RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)" tocid="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1">RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>TaskFolder<span id="LST7B3FF648_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_0?cpp=::|nu=.");</script>RegisterTaskDefinition Method (String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Registers (creates) a task in a specified location using a <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> instance to define a task.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br />
    <strong>Assembly:</strong>
   Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.6.0.0 (2.6.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EDCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cs','1','4');return false;">C#</a></div><div id="ID0EDCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','vb','2','4');return false;">VB</a></div><div id="ID0EDCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cpp','3','4');return false;">C++</a></div><div id="ID0EDCA_tab4" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EDCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EDCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EDCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Task</span> <span class="identifier">RegisterTaskDefinition</span>(
	<span class="identifier">string</span> <span class="parameter">path</span>,
	<span class="identifier">TaskDefinition</span> <span class="parameter">definition</span>,
	<span class="identifier">TaskCreation</span> <span class="parameter">createType</span>,
	<span class="identifier">string</span> <span class="parameter">userId</span>,
	<span class="identifier">string</span> <span class="parameter">password</span> = <span class="keyword">null</span>,
	<span class="identifier">TaskLogonType</span> <span class="parameter">logonType</span> = <span class="identifier">TaskLogonType</span>.S4U,
	<span class="identifier">string</span> <span class="parameter">sddl</span> = <span class="keyword">null</span>
)</pre></div><div id="ID0EDCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">RegisterTaskDefinition</span> ( 
	<span class="parameter">path</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">definition</span> <span class="keyword">As</span> <span class="identifier">TaskDefinition</span>,
	<span class="parameter">createType</span> <span class="keyword">As</span> <span class="identifier">TaskCreation</span>,
	<span class="parameter">userId</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	Optional <span class="parameter">password</span> <span class="keyword">As</span> <span class="identifier">String</span> = <span class="keyword">Nothing</span>,
	Optional <span class="parameter">logonType</span> <span class="keyword">As</span> <span class="identifier">TaskLogonType</span> = <span class="identifier">TaskLogonType</span>.S4U,
	Optional <span class="parameter">sddl</span> <span class="keyword">As</span> <span class="identifier">String</span> = <span class="keyword">Nothing</span>
) <span class="keyword">As</span> <span class="identifier">Task</span></pre></div><div id="ID0EDCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">Task</span>^ <span class="identifier">RegisterTaskDefinition</span>(
	<span class="identifier">String</span>^ <span class="parameter">path</span>, 
	<span class="identifier">TaskDefinition</span>^ <span class="parameter">definition</span>, 
	<span class="identifier">TaskCreation</span> <span class="parameter">createType</span>, 
	<span class="identifier">String</span>^ <span class="parameter">userId</span>, 
	<span class="identifier">String</span>^ <span class="parameter">password</span> = <span class="keyword">nullptr</span>, 
	<span class="identifier">TaskLogonType</span> <span class="parameter">logonType</span> = <span class="identifier">TaskLogonType</span>::S4U, 
	<span class="identifier">String</span>^ <span class="parameter">sddl</span> = <span class="keyword">nullptr</span>
)</pre></div><div id="ID0EDCA_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">RegisterTaskDefinition</span> : 
        <span class="parameter">path</span> : <span class="identifier">string</span> * 
        <span class="parameter">definition</span> : <span class="identifier">TaskDefinition</span> * 
        <span class="parameter">createType</span> : <span class="identifier">TaskCreation</span> * 
        <span class="parameter">userId</span> : <span class="identifier">string</span> * 
        ?<span class="parameter">password</span> : <span class="identifier">string</span> * 
        ?<span class="parameter">logonType</span> : <span class="identifier">TaskLogonType</span> * 
        ?<span class="parameter">sddl</span> : <span class="identifier">string</span> 
(* Defaults:
        <span class="keyword">let </span><span class="identifier">_</span><span class="identifier">password</span> = defaultArg <span class="identifier">password</span> <span class="keyword">null</span>
        <span class="keyword">let </span><span class="identifier">_</span><span class="identifier">logonType</span> = defaultArg <span class="identifier">logonType</span> <span class="identifier">TaskLogonType</span>.S4U
        <span class="keyword">let </span><span class="identifier">_</span><span class="identifier">sddl</span> = defaultArg <span class="identifier">sddl</span> <span class="keyword">null</span>
*)
<span class="keyword">-&gt;</span> <span class="identifier">Task</span> 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EDCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">path</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The task name. If this value is NULL, the task will be registered in the root task folder and the task name will be a GUID value that is created by the Task Scheduler service. A task name cannot begin or end with a space character. The '.' character cannot be used to specify the current task folder and the '..' characters cannot be used to specify the parent task folder in the path.</dd><dt><span class="parameter">definition</span></dt><dd>Type: <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">Microsoft.Win32.TaskScheduler<span id="LST7B3FF648_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskDefinition</a><br />The <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> of the registered task.</dd><dt><span class="parameter">createType</span></dt><dd>Type: <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">Microsoft.Win32.TaskScheduler<span id="LST7B3FF648_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskCreation</a><br />A union of <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">TaskCreation</a> flags.</dd><dt><span class="parameter">userId</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The user credentials used to register the task.</dd><dt><span class="parameter">password</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The password for the userId used to register the task.</dd><dt><span class="parameter">logonType</span> (Optional)</dt><dd>Type: <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">Microsoft.Win32.TaskScheduler<span id="LST7B3FF648_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TaskLogonType</a><br />A <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">TaskLogonType</a> value that defines what logon technique is used to run the registered task.</dd><dt><span class="parameter">sddl</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST7B3FF648_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST7B3FF648_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The security descriptor associated with the registered task. You can specify the access control list (ACL) in the security descriptor for a task in order to allow or deny certain users and groups access to a task.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a><br />
            A <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a> instance that represents the new task. This will return <span class="code">null</span> if <span class="parameter">createType</span> is set to <span class="code">ValidateOnly</span> and there are no validation errors.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/8xt94y6e" target="_blank">ArgumentOutOfRangeException</a></td><td>
            Task names may not include any characters which are invalid for file names.
            or
            Task names ending with a period followed by three or fewer characters cannot be retrieved due to a bug in the native library.
            </td></tr><tr><td><a href="T_Microsoft_Win32_TaskScheduler_NotV1SupportedException.htm">NotV1SupportedException</a></td><td>This LogonType is not supported on Task Scheduler 1.0.
            or
            Security settings are not available on Task Scheduler 1.0.
            or
            Registration triggers are not available on Task Scheduler 1.0.
            or
            XML validation not available on Task Scheduler 1.0.</td></tr></table></div></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Microsoft_Win32_TaskScheduler_TaskFolder.htm">TaskFolder Class</a></div><div class="seeAlsoStyle"><a href="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm">RegisterTaskDefinition Overload</a></div><div class="seeAlsoStyle"><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank">© 2017 Open Source Community. All rights reserved.</a></p> </div></body></html>